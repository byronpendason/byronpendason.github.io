---
title: Test
layout: default
permalink: /test
sitemap:
  exclude: 'yes'
---

<div id="log"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="/js/Astro.js" type="text/javascript"></script>
<script type="text/JavaScript">
  $(document).ready(function() {
    var today = new Date();
    var date = new Date();
    for (let i=0; i<31; i++) {
      date = nextNewMoon(date);
//      $("#log").append(String(getIllum(date))+"<br>");
//      date.setDate(date.getDate()+1);
      $("#log").append(date.toString()+"<br>");
      //$("#log").append("<p>"+date.toString()+"</p>");
    }
//    $("#log").html(String(getIllum(today)));
  });
  
  function nextNewMoon(d) {
    while (getIllum(d)<50) {
      d.setDate(d.getDate()+7);
    }
    while (getIllum(d)<90) {
      d.setDate(d.getDate()+1);
    }
    while (getIllum(d)<99) {
      d.setHours(d.getHours()+1);
    while (getIllum(d)!=0) {
      d.setMinutes(d.getMinutes()+1);
    }
    return d;
  }

  function getIllum(d) {
    // 52.6336° N, 1.6910° W
    var lat = 52.6336;
    var lon = 1.6910;

    var illum = A.Get.moonIllumination(d);
    return Math.floor(illum.phase*100);
  }
</script>
