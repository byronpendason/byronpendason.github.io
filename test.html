---
title: Test
layout: default
permalink: /test
sitemap:
  exclude: 'yes'
---

<p id="log"></p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="/js/Astro.js" type="text/javascript"></script>
<script type="text/JavaScript">
  $(document).ready(function() {
    var today = new Date().getTime();
/*    $("#log").append(today.toString());
    $("#log").append(getIllum(today));*/
    var newMoon = nextNewMoon(today);
    $("#log").append(String(getIllum(newMoon))+"<br>");
    $("#log").append(newMoon.toString());
  });
  
  function nextNewMoon(d) {
    while (getIllum(d)<60) {
      d.setDate(d.getDate()+7);
    }
    while (getIllum(d)<90) {
      d.setDate(d.getDate()+1);
    }
    while (getIllum(d)>1) {
      d.setMinutes(d.getMinutes()+1);
    }
    return d;
  }

  function getIllum(d) {
    // 52.6336° N, 1.6910° W
    var lat = 52.6336;
    var lon = 1.6910;

    var illum = A.Get.moonIllumination(d, lat, lon);
    return illum.illumination;
  }
</script>
